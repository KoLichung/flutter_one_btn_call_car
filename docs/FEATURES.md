# 功能說明文件

## 應用程式架構

```
一鍵叫車 App
│
├── 登入/註冊頁面 (Login Page)
│   ├── 手機號碼登入/註冊
│   └── LINE 登入/註冊
│
└── 主頁 (Home Page) - 底部導航
    ├── 叫車頁面 (Call Car Page)
    └── 個人資料頁面 (Profile Page)
        ├── 個人資料編輯
        └── 叫車紀錄 (Ride History Page)
            └── 行程詳情 (Ride Detail Page)
```

## 詳細功能說明

### 1. 登入/註冊頁面 (LoginPage)

**位置**: `lib/screens/login_page.dart`

#### UI 元件
- **應用程式標誌**: 圓形計程車圖示，帶有陰影效果
- **標題**: "一鍵叫車" 和副標題 "快速、便捷、安全"
- **登入/註冊切換**: 可在登入和註冊模式間切換
- **手機號碼輸入框**: 帶驗證的文字輸入欄位
- **手機登入/註冊按鈕**: 藍色按鈕，根據模式變化文字
- **分隔線**: "或" 字樣的分隔線
- **LINE 登入/註冊按鈕**: 綠色按鈕，LINE 官方色彩

#### 功能
- ✅ 表單驗證（手機號碼格式檢查）
- ✅ 登入/註冊模式切換
- ✅ 手機號碼登入（模擬）
- ✅ LINE 登入（模擬）
- ✅ 漸層背景設計
- ✅ 響應式布局

#### 驗證規則
- 手機號碼必填
- 手機號碼最少 10 位數

---

### 2. 主頁 (HomePage)

**位置**: `lib/screens/home_page.dart`

#### UI 元件
- **底部導航列**: 包含兩個 Tab
  - 叫車 Tab（計程車圖示）
  - 個人資料 Tab（人像圖示）

#### 功能
- ✅ Tab 切換
- ✅ 狀態保持
- ✅ 圖示和文字標籤

---

### 3. 叫車頁面 (CallCarPage)

**位置**: `lib/screens/call_car_page.dart`

#### UI 元件
- **Google Maps**: 全螢幕地圖顯示
- **位置標記**: 
  - 藍色標記（使用者位置）
  - 綠色標記（車輛位置）
- **資訊卡片**（找到車輛時顯示）:
  - 司機照片（圓形圖示）
  - 司機姓名
  - 車牌號碼
  - 預估到達時間
  - 預估車資（上車後顯示）
- **底部操作面板**: 
  - 主要操作按鈕
  - 搜尋中狀態指示器

#### 狀態流程
1. **閒置 (Idle)**: 
   - 顯示 "一鍵叫車" 藍色按鈕
   - 地圖顯示使用者當前位置

2. **搜尋中 (Searching)**:
   - 按鈕變為 "取消叫車" 紅色按鈕
   - 顯示載入動畫和 "搜索附近車輛中..." 文字
   - 模擬 2 秒後找到車輛

3. **找到車輛 (Found)**:
   - 顯示司機資訊卡片
   - 顯示車輛位置標記
   - 顯示預估到達時間
   - 按鈕變為 "確認上車" 綠色按鈕
   - 地圖自動調整以顯示使用者和車輛位置

4. **上車中 (OnBoard)**:
   - 更新資訊卡片顯示預估車資
   - 按鈕變為 "結束行程" 橘色按鈕
   - 顯示行車路徑

#### 功能
- ✅ Google Maps 整合
- ✅ 我的位置顯示
- ✅ 一鍵叫車功能
- ✅ 搜尋附近車輛（模擬）
- ✅ 車輛位置追蹤
- ✅ 預估到達時間
- ✅ 行程中路線顯示
- ✅ 結束行程對話框
- ✅ 車資顯示（現金支付）
- ✅ 自動相機調整

#### 模擬資料
- 司機姓名: 王師傅
- 車牌號碼: ABC-1234
- 預估到達時間: 5 分鐘
- 預估車資: NT$ 150

---

### 4. 個人資料頁面 (ProfilePage)

**位置**: `lib/screens/profile_page.dart`

#### UI 元件
- **頂部個人檔案區**:
  - 頭像圖示（圓形）
  - 使用者暱稱
  - "編輯資料" 按鈕
- **資訊卡片**:
  - 登入方式（手機/LINE）
  - 手機號碼
- **功能選單**:
  - 叫車紀錄
  - 設定（開發中）
  - 幫助與支援（開發中）
- **登出按鈕**: 紅色外框按鈕

#### 功能
- ✅ 顯示使用者資訊
- ✅ 編輯暱稱對話框
- ✅ 導航至叫車紀錄
- ✅ 登出功能
- ✅ 登出確認對話框
- ✅ 精美的卡片設計
- ✅ 圖示和顏色分類

#### 模擬使用者資料
- 暱稱: 測試用戶
- 手機: 0912345678
- 登入方式: 手機登入

---

### 5. 叫車紀錄頁面 (RideHistoryPage)

**位置**: `lib/screens/ride_history_page.dart`

#### UI 元件
- **頂部統計卡片**:
  - 總搭乘次數（大字體顯示）
  - 總花費金額
- **紀錄列表**:
  - 日期時間
  - 狀態標籤（已完成/已取消）
  - 路線視覺化（綠色起點、紅色終點、連接線）
  - 上車地點
  - 下車地點
  - 司機資訊
  - 行程時間
  - 車資

#### 功能
- ✅ 顯示所有叫車紀錄
- ✅ 聰明的日期顯示（今天、昨天、X天前、完整日期）
- ✅ 狀態顏色編碼
- ✅ 點擊查看詳情
- ✅ 總計統計
- ✅ 空狀態提示
- ✅ 卡片式設計
- ✅ 路線視覺指示器

#### 模擬紀錄資料
包含 5 筆歷史叫車紀錄，涵蓋台北各地點：
- 台北車站 → 台北101
- 信義區 → 松山機場
- 西門町 → 台北車站
- 台北101 → 大安森林公園
- 士林夜市 → 淡水老街

---

### 6. 行程詳情頁面 (RideDetailPage)

**位置**: `lib/screens/ride_detail_page.dart`

#### UI 元件
- **Google Maps**（上半部）:
  - 顯示起點和終點標記
  - 顯示行車路線（藍色線）
  - 自動調整視角顯示完整路線
- **詳情面板**（下半部）:
  - 行程日期時間
  - 上車地點（綠色圖示）
  - 下車地點（紅色圖示）
  - 司機資訊卡片
  - 行程摘要（時間和車資）

#### 功能
- ✅ 地圖顯示完整路線
- ✅ 起點和終點標記
- ✅ 路線折線顯示
- ✅ 自動調整相機視角
- ✅ 詳細行程資訊
- ✅ 司機資訊顯示
- ✅ 時間和車資摘要卡片
- ✅ 滑動查看所有詳情

#### 地圖功能
- 綠色標記: 上車地點
- 紅色標記: 下車地點
- 藍色折線: 行車路線
- 自動縮放: 顯示完整路線

---

## 資料模型

### User (使用者)
**位置**: `lib/models/user.dart`

```dart
{
  id: String,          // 使用者 ID
  nickname: String,    // 暱稱
  phone: String,       // 手機號碼
  lineId: String?,     // LINE ID (可選)
  loginMethod: String  // 'phone' 或 'line'
}
```

### RideRecord (叫車紀錄)
**位置**: `lib/models/ride_record.dart`

```dart
{
  id: String,              // 紀錄 ID
  dateTime: DateTime,      // 搭乘時間
  pickupAddress: String,   // 上車地址
  dropoffAddress: String,  // 下車地址
  fare: double,            // 車資
  duration: int,           // 行程時間（分鐘）
  driverName: String,      // 司機姓名
  carNumber: String,       // 車牌號碼
  status: String          // 狀態 (completed, cancelled)
}
```

---

## UI/UX 設計特點

### 顏色主題
- **主色**: 藍色 (Colors.blue)
- **強調色**: 
  - 綠色（成功、起點、LINE）
  - 紅色（取消、終點、登出）
  - 橘色（警告、結束行程）

### 設計原則
- ✨ Material Design 3
- 🎨 圓角設計（borderRadius: 12-24）
- 🌊 漸層背景
- 💫 陰影效果增加深度
- 📱 響應式布局
- 🔘 大按鈕方便點擊
- 📊 視覺化資訊呈現
- 🎯 清晰的狀態指示

### 動畫效果
- 相機移動動畫
- 狀態切換動畫
- 載入指示器
- 頁面轉場

---

## 技術實現

### 依賴套件
- `google_maps_flutter`: 地圖功能
- `geolocator`: 定位功能
- `flutter_polyline_points`: 路線繪製

### 狀態管理
- 使用 `StatefulWidget` 和 `setState`
- 簡單明瞭，易於理解

### 導航
- `Navigator.push` 用於前進
- `Navigator.pushReplacement` 用於登入後跳轉
- Material 路由轉場動畫

---

## 未來可擴展功能

### 即將推出
- [ ] 真實 API 整合
- [ ] 即時定位更新
- [ ] 推送通知
- [ ] 多語言支援

### 進階功能
- [ ] 司機評分系統
- [ ] 即時聊天
- [ ] 多種車型選擇
- [ ] 預約叫車
- [ ] 路線偏好設定
- [ ] 優惠券系統
- [ ] 分享行程
- [ ] 緊急聯絡人

### 後端需求
- [ ] 使用者認證系統
- [ ] 司機配對演算法
- [ ] 即時位置追蹤
- [ ] 行程資料庫
- [ ] 推送通知服務
- [ ] 支付整合（可選）

---

## 測試建議

### 手動測試清單
- [ ] 登入流程（手機/LINE）
- [ ] 叫車完整流程
- [ ] 取消叫車
- [ ] 完成行程
- [ ] 查看紀錄
- [ ] 查看詳情
- [ ] 編輯個人資料
- [ ] 登出

### UI 測試要點
- [ ] 不同螢幕尺寸
- [ ] 橫豎屏切換
- [ ] 各種狀態顯示
- [ ] 按鈕反饋
- [ ] 載入狀態
- [ ] 錯誤處理

---

## 效能優化

### 已實現
- ✅ 單一 Google Maps 實例
- ✅ 按需載入紀錄
- ✅ 優化的地圖標記
- ✅ 高效的狀態更新

### 建議
- 圖片快取
- 列表虛擬化（大量紀錄時）
- 離線支援
- 資料分頁載入

---

## 總結

本應用程式提供了完整的叫車 UI 體驗，包含：
- 🎨 現代化的 UI 設計
- 📱 直覺的使用者體驗
- 🗺️ 完整的地圖整合
- 📊 清晰的資訊呈現
- 🔄 流暢的狀態轉換

所有功能都是 UI 層面的實現，可以輕鬆擴展整合真實的後端服務。

